<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Новини</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background:#f5f7fb; margin:0; padding:1rem; }
        .container { max-width: 900px; margin: 0 auto; background:#fff; padding: 1.5rem; border-radius: 12px; box-shadow: 0 10px 25px rgba(0,0,0,0.06); }
        h1 { margin: 0 0 1rem 0; }
        .card { display:flex; gap:12px; padding:12px; border:1px solid #eef0f4; border-radius:10px; background:#fafbff; margin-bottom:10px; }
        .card img { width: 100px; height:100px; object-fit: cover; border-radius: 8px; }
        details summary { cursor: pointer; }
    </style>
    </head>
<body>
    <header id="mobile-header" style="position:sticky;top:0;background:rgba(255,255,255,0.9);backdrop-filter:blur(8px);display:flex;align-items:center;justify-content:space-between;padding:10px 16px;border-bottom:1px solid #e5e7eb;z-index:1000;">
        <div class="logo" style="font-weight:700;color:#4f46e5;">View2U</div>
        <nav>
            <a href="/" style="text-decoration:none;color:#1f2937;padding:6px 10px;border-radius:8px;">Головна</a>
            <a href="/news.html" style="text-decoration:none;color:#1f2937;padding:6px 10px;border-radius:8px;background:#eef2ff;">Новини</a>
        </nav>
    </header>
    <div class="container">
        <h1>Новини</h1>
        <div id="news"></div>
    </div>
    <script>
        // Restore Junimo state (positions, count) if provided
        try {
            const stateRaw = sessionStorage.getItem('junimo_state');
            if (stateRaw) {
                const st = JSON.parse(stateRaw);
                window.__junimoInitialState = st; // for future usage if needed on this page
            }
        } catch (_) {}
        async function api(action, payload){
            const res = await fetch('/.netlify/functions/public-api', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ action, payload }) });
            return res;
        }
        async function main(){
            const listEl = document.getElementById('news');
            const res = await api('getNews', {});
            if(!res.ok){ listEl.innerHTML = '<p>Не вдалося завантажити новини.</p>'; return; }
            const items = await res.json();
            if(!Array.isArray(items) || items.length === 0){ listEl.innerHTML = '<p>Новин поки немає.</p>'; return; }
            listEl.innerHTML = items.map(n=>`
                <div class="card">
                    ${n.imageUrl ? `<img src="${n.imageUrl}" alt="news">` : ''}
                    <div style="flex:1;">
                        <div style="display:flex; justify-content:space-between; align-items:center;">
                            <strong>${n.title}</strong>
                            <small>${new Date(n.createdAt).toLocaleString()}</small>
                        </div>
                        <details>
                            <summary>Читати</summary>
                            <p style="white-space: pre-wrap;">${(n.text||'')}</p>
                        </details>
                    </div>
                </div>
            `).join('');
        }
        document.addEventListener('DOMContentLoaded', main);
    </script>
</body>
</html>

